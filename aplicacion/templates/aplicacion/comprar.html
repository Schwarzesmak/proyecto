{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="author" content="Untree.co">
    <link rel="shortcut icon" href="{% static 'logo.png' %}">

    <meta name="description" content="" />
    <meta name="keywords" content="bootstrap, bootstrap4" />

    <!-- Bootstrap CSS -->
    <link href="{% static 'aplicacion/css/bootstrap.min.css' %}" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="{% static 'aplicacion/css/tiny-slider.css' %}" rel="stylesheet">
    <link href="{% static 'aplicacion/css/style.css' %}" rel="stylesheet">
    <title>Comprar producto</title>
</head>
<body>
    
   <!-- Start Header/Navigation -->
	<nav class="custom-navbar navbar navbar navbar-expand-md navbar-dark bg-dark" arial-label="Furni navigation bar">

		<div class="container">
			<!-- <a class="navbar-brand" href="index.html">Brama<span>.</span></a> -->
			<a class="navbar-brand" href="{% url "index" %}">Brama<span>.</span></a>

			<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsFurni"
				aria-controls="navbarsFurni" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>

			<div class="collapse navbar-collapse" id="navbarsFurni">
				<ul class="custom-navbar-nav navbar-nav ms-auto mb-2 mb-md-0">
					<!-- <li><a class="nav-link" href="miscompras.html">Mis Compras -->
					<li><a class="nav-link" href="{% url "miscompras" %}">Mis Compras	
						</a></li>
					<li class="nav-item active">
				   <!-- <a class="nav-link" href="index.html">Inicio</a> -->
						<a class="nav-link" href="{% url "index" %}">Inicio</a>
					</li>
			   <!-- <li><a class="nav-link" href="shop.html">Tienda</a></li> -->
					<li><a class="nav-link" href="{% url "shop" %}">Tienda</a></li>
				<!--<li><a class="nav-link" href="about.html">Nosotros</a></li>  -->
					<li><a class="nav-link" href="{% url "about" %}">Nosotros</a></li>
				</ul>

				<ul class="custom-navbar-cta navbar-nav mb-2 mb-md-0 ms-5">
				<!--<li><a class="nav-link" href="sesion.html"><img src="images/user.svg"></a></li> -->
					<li><a class="nav-link" href="{% url "login" %}"><img src="{% static "aplicacion/img/user.svg" %}"></a></li>
				<!--<li><a class="nav-link" href="cart.html"><img src="images/cart.svg"></a></li> -->
					<li><a class="nav-link" href="{% url "cart" %}"><img src="{% static "aplicacion/img/cart.svg" %}"></a></li>
                    <li><a class="nav-link" href="{% url 'salir' %}">Cerrar Sesión</a></li>
				</ul>
			</div>
		</div>

	</nav>
	<!-- End Header/Navigation -->

    <div class="container py-5">
        <div class="row">
            <div class="col-md-6">
                <img src="{{ producto.imagen.url }}" class="card-img-top img-fluid product-thumbnail" alt="Producto">
            </div>
            <div class="col-md-6">
                <h1 class="fw-bold">Producto Increíble</h1>
                <p class="text-muted fs-5">${{ producto.precio}}</p>
                <div class="product-description">
                    <h4 class="mb-3">{{ producto.nombre|capfirst }}</h4>
                    <h4 class="mb-3">Características</h4>
                    <ul class="list-unstyled">
                        <li><strong>Tipo de producto:</strong> {{ producto.tipo_producto }}</li>
                        <li><strong>Tipo de munición:</strong> {{ producto.tipo_municion }}</li>
                        <li><strong>Stock disponible:</strong> {{ producto.stock }}</li>
                    </ul>
                </div>
                <div class="mt-4">
                    <form method="post" action="{% url 'comprar' producto.cod_producto %}">
                        {% csrf_token %}
                        <button id="add-to-cart" type="submit" name="add-to-cart" class="btn btn-success me-3">Añadir al carrito</button>
                        <a href="{% url 'shop' %}" class="btn btn-outline-primary">Volver a la tienda</a>
                    </form>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Bootstrap Bundle JS (Bootstrap JS + Popper.js) -->
    <script src="{% static 'aplicacion/js/bootstrap.bundle.min.js' %}"></script>
    
    {% if messages %}
        {% for message in messages %}
            {% if message.level == 25 %}
                <script>
                    Swal.fire({
                        title: 'Operación realizada',
                        text: '{{ message }}',
                        icon: 'success',
                        confirmButtonText: 'Ok'
                    }).then(() => {
                        setTimeout(function() {
                            window.location.href = "{% url 'cart' %}";
                        }, 2000);
                    });
                </script>
            {% elif message.level == 30 %}
                <script>
                    Swal.fire({
                        title: 'Operación exitosa!',
                        text: '{{ message }}',
                        icon: 'success',
                        confirmButtonText: 'Ok'
                    }).then(() => {
                        setTimeout(function() {
                            window.location.href = "{% url 'cart' %}";
                        }, 2000);
                    });
                </script>
            {% endif %}
        {% endfor %}
    {% endif %}
    
    <script src="{% static 'aplicacion/js/script.js' %}"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>

    <script>
        document.getElementById('add-to-cart').addEventListener('click', function(event) {
            event.preventDefault(); 
            
            Swal.fire({
                title: 'Compra exitosa',
                text: 'Su pedido se ha añadido al carrito correctamente.',
                icon: 'success',
                confirmButtonText: 'Aceptar'
            }).then((result) => {
                if (result.isConfirmed) {
                    setTimeout(() => {
                        window.location.href = "{% url 'cart' %}";
                    }, 1000); 
                }
            });
        });
    </script>

</body>
</html>
